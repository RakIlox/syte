# Отчётность и документация

## Важность качественной отчётности

Отчётность — это заключительный, но один из наиболее важных этапов пентестинга. Даже блестяще проведённое тестирование бесполезно, если клиент не понимает его результатов. Хороший отчёт:
- Чётко объясняет найденные проблемы
- Показывает бизнес-риски
- Даёт конкретные рекомендации
- Помогает исправить уязвимости

Плохой отчёт может привести к тому, что клиент не поймёт серьёзность проблем или не сможет их устранить.

## Структура отчёта о пентестинге

### 1. Титульная страница

```
================================================================================
                    ОТЧЁТ О ТЕСТИРОВАНИИ НА ПРОНИКНОВЕНИЕ
================================================================================

Название проекта: Комплексное тестирование безопасности
                веб-приложения "Корпоративный портал"

Заказчик: ООО "ТехноКорп"

Исполнитель: [Имя компании/пентестера]

Дата проведения: 01 - 15 мая 2025 года

Версия документа: 1.0

Классификация: Конфиденциально

================================================================================
```

### 2. Резюме для руководства (Executive Summary)

Этот раздел должен быть понятен людям без технического образования.

```
РЕЗЮМЕ ДЛЯ РУКОВОДСТВА

Общая оценка безопасности: Средняя ⭐⭐⭐⭐☆

В ходе тестирования было выявлено X уязвимостей различных уровней критичности:

┌────────────────────────────────────────────────────────────────┐
│ Критических    │  1  │  Требуют немедленного внимания         │
├────────────────────────────────────────────────────────────────┤
│ Высоких        │  3  │  Серьёзные риски, устранить в первую   │
│                │     │  очередь                               │
├────────────────────────────────────────────────────────────────┤
│ Средних        │  5  │  Важные уязвимости, исправить в        │
│                │     │  течение месяца                        │
├────────────────────────────────────────────────────────────────┤
│ Низких         │  7  │  Рекомендации по улучшению             │
└────────────────────────────────────────────────────────────────┘

Ключевые находки:

1. Обнаружена критическая уязвимость SQL-инъекции, позволяющая 
   злоумышленнику получить доступ к базе данных с 50,000 
   пользовательских аккаунтов.

2. Система аутентификации уязвима к атаке подбора паролей, 
   что позволяет перебрать 1000 паролей в секунду.

3. Отсутствует защита от CSRF-атак на формах изменения 
   пароля и платёжных операций.

Рекомендуемые действия:

- Немедленно: Исправить SQL-инъекцию и внедрить WAF
- В течение недели: Внедрить rate limiting и 2FA
- В течение месяца: Провести полный аудит кода

Общий вывод: Требуется значительное улучшение безопасности 
веб-приложения для защиты корпоративных данных клиентов.
```

### 3. Методология

Опишите, как проводилось тестирование:

```
МЕТОДОЛОГИЯ

Стандарты:
- OWASP Testing Guide v4.2
- PTES (Penetration Testing Execution Standard)
- NIST SP 800-115

Тип тестирования: 
- Метод: Серый ящик (Gray Box)
- Цели: Веб-приложение, API, инфраструктура

Используемые инструменты:
- Nmap 7.92
- Burp Suite Professional
- OWASP ZAP
- SQLMap
- Metasploit Framework
- PowerView
- Mimikatz

Ограничения тестирования:
- Тестирование проводилось только в рабочие часы
- Не тестировались мобильные приложения
- DoS-атаки были исключены из scope
```

### 4. Обзор тестируемой среды

```
ТЕСТИРУЕМАЯ СРЕДА

┌─────────────────────────────────────────────────────────────────────────┐
│ Хост │ ОС │ Роль │ Сервисы │ Веб-технологии                            │
├──────┼────┼──────┼─────────┼───────────────────────────────────────────┤
│ web  │ Linux │ Web-сервер │ Apache 2.4.41, PHP 7.4 │ WordPress 5.8 │
│ db   │ Linux │ БД │ MySQL 5.7 │ -                                      │
│ api  │ Linux │ API │ Node.js 14 │ Express, MongoDB                      │
└─────────────────────────────────────────────────────────────────────────┘
```

### 5. Детальный анализ уязвимостей

Это основная часть отчёта с техническими деталями:

```
================================================================================
УЯЗВИМОСТЬ #1: SQL-инъекция в модуле поиска
================================================================================

ID: VULN-001
CVE: N/A
CWE: CWE-89 (SQL Injection)
CVSS v3.1: 9.8 (Critical)
Приоритет: P1 - Критический

ОПИСАНИЕ
─────────────────────────────────────────────────────────────────────────────
В модуле поиска товаров обнаружена критическая уязвимость SQL-инъекции 
типа UNION-based. Параметр "category" не проходит достаточной санитизации, 
что позволяет внедрять произвольные SQL-запросы в базу данных.

Веб-приложение уязвимо к эксплуатации как через GET, так и через POST 
запросы. Атакующий может извлекать произвольные данные из базы, включая 
учётные записи пользователей, платёжные данные и внутреннюю информацию.

ТЕХНИЧЕСКОЕ ПОДТВЕРЖДЕНИЕ
─────────────────────────────────────────────────────────────────────────────
HTTP-запрос:
GET /api/products?category=1%27%20UNION%20SELECT%201,2,3,username,password,6,7
%20FROM%20users-- HTTP/1.1
Host: api.example.com
Accept: application/json

Ответ сервера (содержит данные пользователей):
{
  "products": [
    {"id": 1, "name": "2", "description": "3", "category": "4", 
     "username": "admin", "password": "5f4dcc3b5aa765d61d8327deb882cf99", "price": "6"}
  ]
}

Данные успешно извлечены из таблицы users, что подтверждает наличие SQL-инъекции.

ВЛИЯНИЕ И РИСКИ
─────────────────────────────────────────────────────────────────────────────
☑ Полный доступ к базе данных
☑ Компрометация 50,000+ учётных записей пользователей
☑ Потенциальная утечка персональных данных (ПДн)
☑ Репутационные и финансовые потери
☑ Штрафы за нарушение требований по защите данных
☑ Возможность модификации и удаления данных

Сценарий атаки:
1. Атакующий регистрирует аккаунт
2. Отправляет специально сформированный запрос к API
3. Получает хеши паролей всех пользователей
4. Использует хеши для дальнейших атак или продаёт данные

РЕКОМЕНДАЦИИ ПО УСТРАНЕНИЮ
─────────────────────────────────────────────────────────────────────────────
Немедленные меры (24-48 часов):

1. Внедрить параметризованные запросы (Prepared Statements):

   // НЕПРАВИЛЬНО (уязвимый код):
   $category = $_GET['category'];
   $query = "SELECT * FROM products WHERE category = '$category'";
   
   // ПРАВИЛЬНО (безопасный код):
   $category = $_GET['category'];
   $stmt = $pdo->prepare("SELECT * FROM products WHERE category = ?");
   $stmt->execute([$category]);

2. Использовать ORM с параметризованными запросами:
   - Doctrine (PHP)
   - SQLAlchemy (Python)
   - Hibernate (Java)

3. Валидация входных данных:
   $allowed_categories = ['electronics', 'clothing', 'food'];
   if (!in_array($category, $allowed_categories)) {
       die('Invalid category');
   }

4. Применить WAF (Web Application Firewall):
   - ModSecurity
   - Cloudflare WAF
   - AWS WAF

Долгосрочные меры (1-2 недели):

1. Провести code review всех модулей работы с БД
2. Внедрить статический анализ кода (SAST)
3. Настроить мониторинг SQL-запросов
4. Провести обучение разработчиков безопасному кодированию

ССЫЛКИ И ИСТОЧНИКИ
─────────────────────────────────────────────────────────────────────────────
- OWASP SQL Injection Prevention Cheat Sheet
- PortSwigger SQL Injection
- CWE-89: SQL Injection

СТАТУС: Требует немедленного устранения
СРОК: 48 часов
─────────────────────────────────────────────────────────────────────────────
```

### 6. Метрики и статистика

```
СВОДКА ПО УЯЗВИМОСТЯМ

┌─────────────────────────────────────────────────────────────────────────────┐
│                         РАСПРЕДЕЛЕНИЕ ПО КРИТИЧНОСТИ                        │
├─────────┬───────┬──────────────────────────────────────────────────────────┤
│ Уровень │ Кол-во│ Примеры                                                   │
├─────────┼───────┼──────────────────────────────────────────────────────────┤
│ Critical│   1   │ SQL-инъекция в API                                        │
├─────────┼───────┼──────────────────────────────────────────────────────────┤
│ High    │   3   │ • Слабая аутентификация                                   │
│         │       │ • XSS в пользовательском профиле                          │
│         │       │ • Отсутствие CSRF защиты                                  │
├─────────┼───────┼──────────────────────────────────────────────────────────┤
│ Medium  │   5   │ • Информационная утечка в HTTP-заголовках                 │
│         │       │ • Устаревшие JavaScript библиотеки                        │
│         │       │ • Отсутствие заголовков безопасности                       │
│         │       │ • Слабая политика паролей                                 │
│         │       │ • Отсутствие rate limiting                                │
├─────────┼───────┼──────────────────────────────────────────────────────────┤
│ Low     │   7   │ • Раскрытие версии ПО                                     │
│         │       │ • Отсутствие Security.txt                                 │
│         │       │ • Подробные сообщения об ошибках                          │
└─────────┴───────┴──────────────────────────────────────────────────────────┘

Динамика по сравнению с предыдущим тестированием:

Улучшения: +3 уязвимости устранены
Новые уязвимости: -2 (в новом функционале)
Изменение общего уровня: ⬇️ Улучшение
```

### 7. Рекомендации по приоритетам

```
ПРИОРИТЕТНЫЙ ПЛАН УСТРАНЕНИЯ

Фаза 1 - Немедленно (24-48 часов):
───────────────────────────────────────────────────────────────────────────
│ ID   │ Уязвимость                    │ Время │ Ответственный            │
│------│-------------------------------|-------|--------------------------│
│ V001 │ SQL-инъекция в API            │ 4 ч  │ Backend команда          │
│ V002 │ Внедрение WAF                 │ 2 ч  │ DevOps                   │
───────────────────────────────────────────────────────────────────────────

Фаза 2 - Срочно (1 неделя):
───────────────────────────────────────────────────────────────────────────
│ ID   │ Уязвимость                    │ Время │ Ответственный            │
│------│-------------------------------|-------|--------------------------│
│ V003 │ Усиление аутентификации       │ 8 ч  │ Backend + Security       │
│ V004 │ CSRF защита                   │ 4 ч  │ Frontend команда         │
│ V005 │ Внедрение rate limiting       │ 4 ч  │ DevOps                   │
───────────────────────────────────────────────────────────────────────────

Фаза 3 - Важно (1 месяц):
───────────────────────────────────────────────────────────────────────────
│ ID   │ Уязвимость                    │ Время │ Ответственный            │
│------│-------------------------------|-------|--------------------------│
│ V006 │ Обновление JavaScript         │ 6 ч  │ Frontend                 │
│ V007 │ Заголовки безопасности        │ 2 ч  │ DevOps                   │
│ V008 │ Политика паролей              │ 4 ч  │ Backend + Security       │
└───────────────────────────────────────────────────────────────────────────
```

### 8. Приложения

**Приложение A: Список используемых инструментов**

```
ИНСТРУМЕНТЫ

┌──────────────────────┬─────────────────────────────────────────────────────┐
│ Инструмент           │ Версия │ Назначение                                  │
├──────────────────────┼────────┼─────────────────────────────────────────────┤
│ Nmap                 │ 7.92   │ Сканирование портов                         │
│ Burp Suite           │ 2023.1 │ Тестирование веб-приложений                 │
│ OWASP ZAP            │ 2.12.0 │ Сканирование уязвимостей                    │
│ SQLMap               │ 1.7    │ Эксплуатация SQL-инъекций                   │
│ Metasploit           │ 6.3    │ Фреймворк для эксплуатации                  │
│ PowerView            │ 3.0    │ Разведка в Active Directory                 │
│ Mimikatz             │ 2.2.0  │ Извлечение учётных данных Windows           │
│ CrackMapExec         │ 6.1    │ Продвижение по сети Windows                 │
└──────────────────────┴────────┴─────────────────────────────────────────────┘
```

**Приложение B: Сокращения и термины**

```
ТЕРМИНЫ

CVE     - Common Vulnerabilities and Exposures
CWE     - Common Weakness Enumeration  
CVSS    - Common Vulnerability Scoring System
CSRF    - Cross-Site Request Forgery
LPE     - Local Privilege Escalation
OSINT   - Open Source Intelligence
RCE     - Remote Code Execution
SQLi    - SQL Injection
WAF     - Web Application Firewall
XSS     - Cross-Site Scripting
```

**Приложение C: Скриншоты и логи**

[Скриншоты подтверждения уязвимостей, логи сканирования и т.д.]

## Практические советы по написанию отчётов

### Язык и стиль

1. **Используйте понятный язык** — избегайте жаргона в разделах для руководства
2. **Будьте конкретны** — вместо "плохо настроен" пишите "отсутствует проверка ввода"
3. **Количественно оценивайте** — "70% паролей подбираются за час" убедительнее "пароли слабые"
4. **Связывайте с бизнес-рисками** — объясните последствия в терминах бизнеса

### Оформление

1. **Используйте единообразный стиль** — одинаковые заголовки, форматирование
2. **Визуализируйте данные** — таблицы, диаграммы, инфографика
3. **Нумеруйте страницы и разделы** — легче ссылаться
4. **Укажите версию документа** — для отслеживания изменений

### Quality Check

Перед отправкой проверьте:
- [ ] Все уязвимости имеют CVE/CWE где применимо
- [ ] CVSS рассчитан корректно
- [ ] Рекомендации конкретны и выполнимы
- [ ] Нет орфографических ошибок
- [ ] Форматирование единообразно
- [ ] Файлы не превышают размер для отправки

## Шаблоны отчётов

### Шаблон для небольших проектов

```markdown
# Отчёт о тестировании безопасности
# [Название проекта]

**Дата:** [Дата]
**Тестировщик:** [Имя]
**Заказчик:** [Организация]

## 1. Executive Summary
[Общий обзор в 2-3 абзаца]

## 2. Методология
[Использованные стандарты и инструменты]

## 3. Найденные уязвимости

### [Название уязвимости #1]
- **ID:** V-001
- **CVSS:** [score]
- **Статус:** [Открыта/Исправлена]
- **Описание:** [...]
- **Влияние:** [...]
- **Рекомендация:** [...]

## 4. Общий статус
| Критических | Высоких | Средних | Низких |
|-------------|---------|---------|--------|
| X | X | X | X |

## 5. Рекомендации
[Приоритетный список]

## 6. Приложения
[Скриншоты, логи]
```

## Инструменты для отчётности

- **Dradis Framework** — платформа для совместной работы
- **Faraday** — management-платформа для пентестинга
- **Serpico** — генератор отчётов
- **Metasploit Reporting** — отчёты из Metasploit
- **Nessus Reports** — шаблоны отчётов Nessus

## Выводы

Качественная отчётность — это искусство баланса между технической точностью и понятностью для бизнеса. Инвестируйте время в создание хороших отчётов: они помогают клиентам понять риски и принять меры, защищая их от реальных атак.

---

**Следующий урок:** Правовые аспекты и этика — юридические рамки этичного хакинга.

