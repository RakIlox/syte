# Методология пентестинга

## Введение в методологии

Методология пентестинга — это структурированный подход к проведению тестирования на проникновение. Она обеспечивает системность, воспроизводимость и полноту проверки. Без методологии пентестинг превращается в хаотичный поиск уязвимостей, который легко пропускает критические проблемы.

Существует несколько признанных методологий, каждая со своими особенностями и областями применения.

## Основные методологии

### 1. PTES (Penetration Testing Execution Standard)

PTES — это наиболее полная и структурированная методология, разработанная экспертами индустрии. Она охватывает все этапы пентестинга от начала до конца.

**7 фаз PTES:**

1. **Pre-engagement Interactions** — взаимодействие до начала проекта
2. **Intelligence Gathering** — сбор разведывательных данных
3. **Threat Modeling** — моделирование угроз
4. **Vulnerability Analysis** — анализ уязвимостей
5. **Exploitation** — эксплуатация
6. **Post Exploitation** — пост-эксплуатация
7. **Reporting** — отчётность

### 2. OWASP Testing Guide

Специализированная методология для тестирования веб-приложений. Включает более 200 конкретных тестов для проверки безопасности.

**Категории тестов OWASP:**
- Information Gathering
- Configuration and Deployment Management Testing
- Identity Management Testing
- Authentication Testing
- Authorization Testing
- Session Management Testing
- Input Validation Testing
- Error Handling
- Cryptography
- Business Logic Testing
- Client-side Testing

### 3. NIST SP 800-115

Методология от Национального института стандартов и технологий США. Используется в государственных и военных организациях.

**Четыре фазы NIST:**
1. **Planning** — планирование
2. **Discovery** — обнаружение (разведка)
3. **Attack** — атака (эксплуатация)
4. **Reporting** — отчётность

### 4. OSSTMM (Open Source Security Testing Methodology Manual)

Методология с научным подходом, фокусируется на измеримости результатов тестирования.

## Детальный разбор фаз пентестинга

### Фаза 1: Подготовка и планирование

**Определение целей тестирования**

Перед началом работы необходимо чётко определить:
- Какие системы будут тестироваться
- Какие методы разрешены
- Какие цели достичь (найти все уязвимости? проверить конкретные сценарии?)
- Каковы временные рамки

**Сбор информации о компании**

Изучите:
- Структуру организации
- Используемые технологии
- Предыдущие аудиты и их результаты
- Бизнес-процессы

**Правовые аспекты**

Подготовьте:
- Соглашение о неразглашении (NDA)
- Разрешение на тестирование (RoE — Rules of Engagement)
- План эскалации (что делать при обнаружении критической уязвимости)
- Контакты для связи в чрезвычайных ситуациях

**Пример Rules of Engagement:**

```
Правила проведения тестирования на проникновение

1. Цель тестирования: Веб-приложение https://app.example.com
2. Разрешённые методы:
   - Сканирование портов
   - Тестирование веб-уязвимостей
   - Попытки эксплуатации
3. Запрещённые методы:
   - DoS/DDoS атаки
   - Социальная инженерия
   - Физический доступ
4. Время проведения: 01.06.2025 - 15.06.2025
5. Рабочие часы: 09:00 - 18:00 MSK
6. Эскалация: Критические уязвимости сообщаются немедленно
7. Контактное лицо: Иван Иванов, security@example.com
```

### Фаза 2: Сбор разведывательных данных

**Пассивная разведка**

Не взаимодействуя напрямую с целевой системой:
- Поиск информации в открытых источниках (OSINT)
- Анализ DNS записей
- Изучение социальных сетей сотрудников
- Поиск утекших данных
- Анализ сертификатов SSL/TLS

**Инструменты пассивной разведки:**
- theHarvester — сбор email, поддоменов
- Shodan — поиск подключённых устройств
- Censys — поиск серверов и сертификатов
- Whois — информация о домене
- Google Dorks — продвинутый поиск

**Активная разведка**

Прямое взаимодействие с целевой системой:
- Сканирование портов
- Traceroute
- Определение технологий на сайте
- Сбор метаданных файлов

### Фаза 3: Моделирование угроз

Создайте модель угроз для понимания:
- Какие активы наиболее ценны
- Кто может быть атакующим
- Какие пути атаки наиболее вероятны
- Какие уязвимости наиболее критичны

**Метод STRIDE:**
- Spoofing — подмена личности
- Tampering — незаконное изменение данных
- Repudiation — отрицание действий
- Information Disclosure — утечка информации
- Denial of Service — отказ в обслуживании
- Elevation of Privilege — повышение привилегий

### Фаза 4: Анализ уязвимостей

**Автоматическое сканирование**

Использование сканеров уязвимостей:
- Nessus
- OpenVAS
- Qualys
- Nikto

**Ручной анализ**

Проверка специфических уязвимостей:
- OWASP Top 10
- CVE (Common Vulnerabilities and Exposures)
- Конфигурационные ошибки

### Фаза 5: Эксплуатация

Попытка использовать найденные уязвимости для получения доступа.

**Типы эксплойтов:**
- Сетевые эксплойты
- Веб-эксплойты
- Локальные эксплойты
- Социальная инженерия

### Фаза 6: Пост-эксплуатация

После успешного проникновения:
- Расширение привилегий
- Продвижение по сети
- Сбор данных
- Установка постоянного доступа

### Фаза 7: Отчётность

Создание отчёта с:
- Описанием найденных уязвимостей
- Уровнем критичности
- Шагами воспроизведения
- Рекомендациями по устранению

## Практический пример

**Сценарий:** Тестирование веб-приложения интернет-магазина

| Этап | Действия | Результат |
|------|----------|-----------|
| Разведка | Сбор поддоменов, технологий | Найдены dev.example.com, test.example.com |
| Сканирование | Nmap, WhatWeb | Apache 2.4, PHP 7.4, WordPress |
| Анализ уязвимостей | WPScan, Nikto | Найдены устаревшие плагины |
| Эксплуатация | WordPress RCE | Получен shell |
| Пост-эксплуатация | Повышение привилегий | root доступ к серверу |
| Отчётность | Документирование | 15 уязвимостей разной критичности |

## Рекомендации по выбору методологии

- **Для веб-приложений:** OWASP Testing Guide
- **Для комплексного тестирования:** PTES
- **Для государственных организаций:** NIST SP 800-115
- **Для исследовательских проектов:** OSSTMM

## Выводы

Методология — это фундамент качественного пентестинга. Она обеспечивает системность, позволяет не пропустить важные этапы и гарантирует воспроизводимость результатов. Выберите методологию, соответствующую вашим задачам, и строго следуйте ей.

---

**Следующий урок:** Разведка и сбор информации — подробно изучим методы сбора данных о цели.

